<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org" 
      th:replace="~{layouts/base :: layout(~{::title}, ~{::section}, ~{::script})}">
<head>
    <title>Beranda - Toko App</title>
</head>
<body>

    <section>
        <!-- CSS Khusus untuk Dashboard ini -->
        <style>
            /* Font yang lebih modern */
            body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            }

            /* --- Styles untuk Kartu Statistik --- */
            .stat-card {
                border: none;
                border-radius: 20px; /* Sudut lebih bulat */
                position: relative;
                overflow: hidden;
                transition: all 0.3s ease;
                min-height: 180px;
                color: white;
            }
            .stat-card:hover {
                transform: translateY(-5px); /* Efek naik saat hover */
                box-shadow: 0 15px 30px rgba(0,0,0,0.15) !important;
            }
            
            /* Background Gradiasi */
            .bg-gradient-blue { background: linear-gradient(135deg, #4e73df 0%, #224abe 100%); }
            .bg-gradient-green { background: linear-gradient(135deg, #1cc88a 0%, #13855c 100%); }
            .bg-gradient-gold { background: linear-gradient(135deg, #f6c23e 0%, #dda20a 100%); }

            /* Ikon Besar Transparan di Background */
            .stat-icon-bg {
                position: absolute;
                right: -10px;
                bottom: -10px;
                font-size: 8rem;
                opacity: 0.1;
                transform: rotate(-15deg);
                pointer-events: none;
            }

            /* --- Styles untuk Quick Actions --- */
            .action-card {
                border: 1px solid #f0f0f0;
                border-radius: 15px;
                background: #fff;
                transition: all 0.3s;
                text-decoration: none;
                color: #333;
                display: flex;
                align-items: center;
                padding: 20px;
                height: 100%;
            }
            .action-card:hover {
                border-color: #4e73df;
                background-color: #f8f9fc;
                transform: translateY(-3px);
                box-shadow: 0 5px 15px rgba(78, 115, 223, 0.1);
                color: #4e73df;
            }
            .action-icon-box {
                width: 50px;
                height: 50px;
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                margin-right: 15px;
            }
        </style>

        <!-- ========================================== -->
        <!-- TAMPILAN JIKA BELUM LOGIN (Hero Section)   -->
        <!-- ========================================== -->
        <div th:if="${user == null}" class="py-5">
            <div class="row align-items-center justify-content-center py-5">
                <div class="col-lg-8 text-center">
                    <div class="mb-4">
                        <i class="fas fa-store fa-4x text-primary mb-3"></i>
                        <h1 class="display-4 fw-bold text-dark">Selamat Datang di Toko App</h1>
                    </div>
                    <p class="lead text-muted mb-5 px-lg-5">
                        Platform manajemen inventaris modern untuk mengelola produk, stok, dan memantau aset bisnis Anda secara 
                        <span class="fw-bold text-primary">Real-Time</span>.
                    </p>
                    <div class="d-flex justify-content-center gap-3">
                        <a th:href="@{/auth/login}" class="btn btn-primary btn-lg px-5 shadow-sm rounded-pill fw-bold">
                            <i class="fas fa-sign-in-alt me-2"></i> Masuk
                        </a>
                        <a th:href="@{/auth/register}" class="btn btn-outline-secondary btn-lg px-5 rounded-pill fw-bold">
                            Daftar Akun
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- TAMPILAN JIKA SUDAH LOGIN (Dashboard)      -->
        <!-- ========================================== -->
        <div th:if="${user != null}" class="container-fluid py-2">
            
            <!-- Welcome Banner -->
            <div class="d-flex justify-content-between align-items-end mb-5">
                <div>
                    <h6 class="text-uppercase text-muted fw-bold small ls-1">Dashboard Overview</h6>
                    <h2 class="fw-bold text-dark mb-0">
                        Halo, <span class="text-primary" th:text="${user.name}">User</span>! ðŸ‘‹
                    </h2>
                </div>
                <div class="d-none d-md-block text-end">
                    <span class="badge bg-light text-dark border px-3 py-2 rounded-pill">
                        <i class="far fa-calendar-alt me-2"></i>
                        <span th:text="${#temporals.format(#temporals.createNow(), 'EEEE, dd MMMM yyyy')}">Tanggal</span>
                    </span>
                </div>
            </div>

            <!-- Grid Kartu Statistik -->
            <div class="row g-4 mb-5">
                
                <!-- KARTU 1: TOTAL PRODUK (Biru) -->
                <div class="col-md-4">
                    <div class="card stat-card bg-gradient-blue shadow-lg">
                        <div class="card-body p-4 d-flex flex-column justify-content-between h-100">
                            <div>
                                <h6 class="text-white text-uppercase opacity-75 fw-bold small">Total Produk</h6>
                                <h2 class="display-4 fw-bold mb-0" th:text="${totalProducts}">0</h2>
                                <span class="badge bg-white bg-opacity-25 rounded-pill fw-normal mt-2 px-3">Item di Gudang</span>
                            </div>
                            <div class="mt-4">
                                <a th:href="@{/products}" class="text-white text-decoration-none fw-bold small stretched-link">
                                    Lihat Detail <i class="fas fa-arrow-right ms-1"></i>
                                </a>
                            </div>
                        </div>
                        <!-- Ikon Background -->
                        <i class="fas fa-box-open stat-icon-bg"></i>
                    </div>
                </div>

                <!-- KARTU 2: KATEGORI (Hijau) -->
                <div class="col-md-4">
                    <div class="card stat-card bg-gradient-green shadow-lg">
                        <div class="card-body p-4 d-flex flex-column justify-content-between h-100">
                            <div>
                                <h6 class="text-white text-uppercase opacity-75 fw-bold small">Kategori Unik</h6>
                                <h2 class="display-4 fw-bold mb-0" th:text="${totalCategories}">0</h2>
                                <span class="badge bg-white bg-opacity-25 rounded-pill fw-normal mt-2 px-3">Variasi Produk</span>
                            </div>
                            <div class="mt-4">
                                <a th:href="@{/products/chart}" class="text-white text-decoration-none fw-bold small stretched-link">
                                    Lihat Grafik <i class="fas fa-chart-pie ms-1"></i>
                                </a>
                            </div>
                        </div>
                        <i class="fas fa-tags stat-icon-bg"></i>
                    </div>
                </div>

                <!-- KARTU 3: ASET (Kuning/Emas) -->
                <div class="col-md-4">
                    <div class="card stat-card bg-gradient-gold shadow-lg">
                        <div class="card-body p-4 d-flex flex-column justify-content-between h-100">
                            <div>
                                <h6 class="text-dark text-uppercase opacity-75 fw-bold small">Estimasi Aset</h6>
                                <h2 class="display-6 fw-bold mb-0 text-dark" 
                                    th:text="'Rp ' + ${#numbers.formatDecimal(totalAssetValue, 0, 'COMMA', 0, 'POINT')}">Rp 0</h2>
                                <span class="badge bg-dark bg-opacity-10 text-dark rounded-pill fw-normal mt-2 px-3">Total Valuasi</span>
                            </div>
                            <div class="mt-4 text-dark opacity-75 small fw-bold">
                                <i class="fas fa-check-circle me-1"></i> Updated Real-time
                            </div>
                        </div>
                        <i class="fas fa-wallet stat-icon-bg text-dark"></i>
                    </div>
                </div>
            </div>

            <!-- Section Aksi Cepat -->
            <h5 class="fw-bold mb-3 text-dark border-start border-4 border-primary ps-3">Aksi Cepat</h5>
            <div class="row g-3">
                <div class="col-md-6 col-lg-4">
                    <a th:href="@{/products/create}" class="action-card shadow-sm">
                        <div class="action-icon-box bg-primary bg-opacity-10 text-primary">
                            <i class="fas fa-plus"></i>
                        </div>
                        <div>
                            <h6 class="fw-bold mb-1">Tambah Produk Baru</h6>
                            <small class="text-muted">Input stok barang masuk</small>
                        </div>
                        <i class="fas fa-chevron-right ms-auto text-muted"></i>
                    </a>
                </div>
                
                <div class="col-md-6 col-lg-4">
                    <a th:href="@{/products}" class="action-card shadow-sm">
                        <div class="action-icon-box bg-info bg-opacity-10 text-info">
                            <i class="fas fa-list-ul"></i>
                        </div>
                        <div>
                            <h6 class="fw-bold mb-1">Kelola Daftar Produk</h6>
                            <small class="text-muted">Edit atau hapus data</small>
                        </div>
                        <i class="fas fa-chevron-right ms-auto text-muted"></i>
                    </a>
                </div>

                 <div class="col-md-6 col-lg-4">
                    <a th:href="@{/products/chart}" class="action-card shadow-sm">
                        <div class="action-icon-box bg-success bg-opacity-10 text-success">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div>
                            <h6 class="fw-bold mb-1">Analisis Stok</h6>
                            <small class="text-muted">Lihat grafik visual</small>
                        </div>
                        <i class="fas fa-chevron-right ms-auto text-muted"></i>
                    </a>
                </div>
            </div>

        </div>
    </section>

    <!-- Script Placeholder -->
    <script></script>

</body>
</html>